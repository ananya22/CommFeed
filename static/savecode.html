<!DOCTYPE html>
<html>


<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Community Kitchen</title>
    <meta charset="UTF-8">

<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">

    <!-- Bootstrap -->
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
    <link href="styles.css" rel="stylesheet">
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="js/lib/jquery.i18n/jquery.i18n.js"></script>
    <script src="js/lib/jquery.i18n/jquery.i18n.messagestore.js"></script>
    <script src="js/lib/jquery.i18n/jquery.i18n.fallbacks.js"></script>
    <script src="js/lib/jquery.i18n/jquery.i18n.language.js"></script>
    <script src="js/lib/jquery.i18n/jquery.i18n.parser.js"></script>
    <script src="js/lib/jquery.i18n/jquery.i18n.emitter.js"></script>
    <script src="js/lib/jquery.i18n/jquery.i18n.emitter.bidi.js"></script>
    <script src="antixss.js" type="text/javascript"></script>


    <style>
            body {font-family: Arial;}
            
            /* Style the tab */
            .tab {
              overflow: hidden;
              border: 1px solid #ccc;
              background-color: #f1f1f1;
            }
            
            /* Style the buttons inside the tab */
            .tab button {
              background-color: inherit;
              float: left;
              border: none;
              outline: none;
              cursor: pointer;
              padding: 14px 16px;
              transition: 0.3s;
              font-size: 17px;
            }
            
            /* Change background color of buttons on hover */
            .tab button:hover {
              background-color: #ddd;
            }
            
            /* Create an active/current tablink class */
            .tab button.active {
              background-color: #ccc;
            }
            
            /* Style the tab content */
            .tabcontent {
              display: none;
              padding: 6px 12px;
              -webkit-animation: fadeEffect 1s;
              animation: fadeEffect 1s;
            }
            
            /* Fade in tabs */
            @-webkit-keyframes fadeEffect {
              from {opacity: 0;}
              to {opacity: 1;}
            }
            
            @keyframes fadeEffect {
              from {opacity: 0;}
              to {opacity: 1;}
            }
            /* Set the size of the div element that contains the map */
      #map {
        height: 400px;  /* The height is 400 pixels */
        width: 100%;  /* The width is the width of the web page */
       }
            </style>

    <script>
        $( document ).ready(function() {
            $.i18n().load( {
                en: {
                    "welcome": "Welcome.",
                    "name": "name",
                    "what_is_your_name": "What is your name?",
                    "hello": "Hello $1",
                    "added_to_database": "Hello $1, I've added you to the database! for $2",
                    "database_contents": "Database contents: "
                },
                ja: {
                    "welcome": "ようこそ。",
                    "name": "名前",
                    "what_is_your_name": "お名前を教えてください。",
                    "hello": "こんにちは $1",
                    "added_to_database": "こんにちは $1 さん、あなたをデータベースに追加しました。",
                    "database_contents": "データベースの内容: "
                }
            } );
            $('body').i18n();
            $('#type1').attr("placeholder", $.i18n('type') );
            $('#quantity').attr("placeholder", $.i18n('quantity') );
            $('#name').attr("placeholder", $.i18n('name') );
            $('#email').attr("placeholder", $.i18n('email') );
            $('#phone').attr("placeholder", $.i18n('phone') );
            $('#location').attr("placeholder", $.i18n('location') );
        });
        </script>

</head>

<body>
    <!-- Navbar (sit on top) -->
<div class="w3-top">
        <div class="w3-bar w3-white w3-wide w3-padding w3-card">
          <a href="#home" class="w3-bar-item w3-button"><b>CTS</b> Community Kitchen</a>
          <!-- Float links to the right. Hide them on small screens -->
          <div class="w3-right w3-hide-small">
            <a href="#About" class="w3-bar-item w3-button">About</a>
            <a href="#donate" class="w3-bar-item w3-button">Donate</a>
            <a href="#supplier" class="w3-bar-item w3-button">Supply</a>
            <a href="#map" class="w3-bar-item w3-button">Map</a>
          </div>
        </div>
      </div>
      
      <!-- Header -->
      <header class="w3-display-container w3-content w3-wide" style="max-width:1500px;" id="home">
        <img class="w3-image" src="/header_img.png" alt="Architecture" width="1500" height="800">
        <div class="w3-display-middle w3-margin-top w3-center">
          <h1 class="w3-xxlarge w3-text-white"><span class="w3-padding w3-black w3-opacity-min"><b>CTS</b></span> <span class="w3-hide-small w3-text-light-grey">Community Kitchen</span></h1>
        </div>
      </header>


      <!-- Page content -->
    <div class="w3-content w3-padding" style="max-width:1564px">
        <!-- About Section -->
  <div class="w3-container w3-padding-32" id="About">
        <h3 class="w3-border-bottom w3-border-light-grey w3-padding-16">About</h3>
        <p>There is a growing interest in enabling communities to cooperate among themselves to solve problems in times of crisis, whether it be to advertise where supplies are held, offer assistance for collections, or other local services like volunteer deliveries.
        </p>
        <p>For example, with the 2020 SARS-COV-2 (COVID-19 or “Novel Coronavirus”) crisis, federal and local governments may be rolling out broad programs, but cooperation at the local level is usually the most effective way of getting help to where it is most needed as quickly as possible. Traditional social media is one way of communicating within a community, but this is often not sufficiently structured to enable rapid discovery of help needed.</p>
         
        <p>In the current crisis, we have already seen shortages of local food, medical equipment, and other supplies. In addition, the recommended (or required) self-isolation and social distancing measures can compound the problem by preventing people from easily getting to locations with the best stocks of supplies.</p>

        <p>What is needed is a solution that empowers communities to easily connect and provide this information to each other.</p>
    </div>

    <!-- Contact Section -->
  <div class="w3-container w3-padding-32" id="donate">
        <h3 class="w3-border-bottom w3-border-light-grey w3-padding-16">Please Enter Detail to Donate</h3>
        
        <div class="container" id="container">
                <h1 data-i18n="Donate Form"></h1> <!- Welcome ->
                <div id="nameInput" class="input-group-lg left-block helloInput">                    
                    <input id="type1" type="text" class="form-control" aria-describedby="sizing-addon1" value="" placeholder="Product Name to Doname" /></br>
                    <input id="quantity" type="text" class="form-control" aria-describedby="sizing-addon1" value=""  placeholder="Quantity"/></br>
                    <input id="name" type="text" class="form-control" aria-describedby="sizing-addon1" value="" placeholder="Name" /></br>
                    <input id="phone" type="text" class="form-control" aria-describedby="sizing-addon1" value=""  placeholder="Phone No"/></br>
                    <input id="email" type="text" class="form-control" aria-describedby="sizing-addon1" value="" placeholder="Email" /></br>
                    <input id="location" type="text" class="form-control" aria-describedby="sizing-addon1" value=""  placeholder="Location"/></br>
                <p></p>press enter to sublit</p> 
                </div>

                <p id="response" class="lead text-center"></p>
        
                <p id="databaseNames" class="lead text-center"></p>
            </div>
      </div>

      <!-- Contact Section -->
  <div class="w3-container w3-padding-32" id="donate">
        <h3 class="w3-border-bottom w3-border-light-grey w3-padding-16">Supplier</h3>
        <p>Lets get in touch and talk about your next project.</p>
        <div class="container" id="supplier">
                <h1 data-i18n="welcome"></h1> <!- Welcome ->
                <div id="nameInput" class="input-group-lg left-block helloInput">                    
                    <input id="user_email" type="text" class="form-control" aria-describedby="sizing-addon1" value="" placeholder="Name" /></br>
                    <input id="user_name" type="text" class="form-control" aria-describedby="sizing-addon1" value=""  placeholder="Name"/></br>
                </div>
                <p id="response" class="lead text-center"></p>
        
                <p id="databaseNames" class="lead text-center"></p>
            </div>
      </div>
      
    <!-- Image of location/map -->
<div class="w3-container">
        <h3>My Google Maps Demo</h3>
        <!--The div element for the map -->
        <div id="map"></div>
        <script>
    // Initialize and add the map
    function initMap() {
      // The location of Uluru
      var uluru = {lat: -25.344, lng: 131.036};
      // The map, centered at Uluru
      var map = new google.maps.Map(
          document.getElementById('map'), {zoom: 4, center: uluru});
      // The marker, positioned at Uluru
      var marker = new google.maps.Marker({position: uluru, map: map});
    }
        </script>
        <!--Load the API from the specified URL
        * The async attribute allows the browser to render the page while the API loads
        * The key parameter will contain your own API key (which is not needed for this tutorial)
        * The callback parameter executes the initMap() function
        -->
        <script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCK6ZC6g2YiYAezQvLv6Hnhks6B83HhHbk&callback=initMap">
        </script>
      </div>
        

    </div>      
      
    
    <footer class="footer">
        <div class="container">
            <span><a href="https://console.bluemix.net/docs/tutorials/index.html" target="_blank">Looking for more tutorials?</a></span>
        </div>
    </footer>

</body>


</html>


<script>
    	//Submit data when enter key is pressed
        $('#location').keydown(function(e) {
        	var type1 = $('#type1').val();
            var quantity = $('#quantity').val();
            var name = $('#name').val();
            var phone = $('#phone').val();
            var email = $('#email').val();
            var location = $('#location').val();
            if (e.which == 13 && name.length > 0) { //catch Enter key
            	//POST request to API to create a new visitor entry in the database
                $.ajax({
				  method: "POST",
				  url: "./api/visitors",
				  contentType: "application/json",
				  data: JSON.stringify({type1: type1,quantity: quantity, name: name, phone:phone, email: email, location: location })
				})
                .done(function(data) {
                    if(data && data.name && data.email){
                        if(data._id)
                            $('#response').html($.i18n('added_to_database', AntiXSS.sanitizeInput(data.name),' ', AntiXSS.sanitizeInput(data.email)));
                            
                        else
                            $('#response').html($.i18n('hello', AntiXSS.sanitizeInput(data.name), AntiXSS.sanitizeInput(data.email))); 
                    }
                    else {
                        $('#response').html(AntiXSS.sanitizeInput(data));
                    }
                    $('#location').hide();
                    getNames();
                });
            }
        });

        //Retrieve all the visitors from the database
        function getNames(){
          $.get("./api/visitors")
              .done(function(data) {
                  if(data.length > 0) {
                    data.forEach(function(element, index) {
                      data[index] = AntiXSS.sanitizeInput(element)
                    });
                    $('#databaseNames').html($.i18n('database_contents') + JSON.stringify(data));
                  }
              });
          }

          //Call getNames on page load.
          getNames();

          


    </script>
